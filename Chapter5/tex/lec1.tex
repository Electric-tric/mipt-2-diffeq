\section{Глава 5. Первые интегралы. Линейные однородные дифференциальные уравнения с частными производными первого порядка.}

В этой главе все величины вещественны.

\subsection{Первые интегралы.}

\point{1} Мы будем рассматривать такую систему:
$$
  \dfrac{\id x_1}{\mathcal{F}_1(x_1, \ldots, x_n)} =
  \dfrac{\id x_2}{\mathcal{F}_2(x_1, \ldots, x_n)} =
  \cdots =
  \dfrac{\id x_n}{\mathcal{F}_n(x_1, \ldots, x_n)} \eqno (1)
$$
где $\F_1, \ldots, \F_n$ определены в области $\underset{x_1,\ldots, x_n}{G}$,
непрерывны там вместе с первыми частными производными, в каждой точке $G$ имеет место $\F_1 \ne 0$, или $\ldots$, или $\F_n \ne 0$.

Возьмём $\any \vec a \in G; \, \exists k \such \F_k (\vec a) \ne 0$.
Построим вспомогательную нормальную систему обыкновенных дифференциальных уравнений:
$$
\begin{array}{cc}
  \dfrac{\id x_{1}}{\id x_k} = \dfrac{\id \F_{1}}{\id \F_k} & \dfrac{\id x_{k+1}}{\id x_k} = \dfrac{\id \F_{k+1}}{\id \F_k} \\
  \cdots & \cdots \\
  \dfrac{\id x_{k-1}}{\id x_k} = \dfrac{\id \F_{k-1}}{\id \F_k} & \dfrac{\id x_{n}}{\id x_k} = \dfrac{\id \F_{n}}{\id \F_k}
\end{array}
\eqno (2_k)
$$
Каждое решение системы $(2_k)$ по определению называется решением системы $(1)$

\Th Пусть на каком-либо решении $(2_k)$ имеет место $\F_s \ne 0$. Тогда это решение удовлетворяет $(2_s)$.

\Rem Важно, что эти конкурирующие возможности не противоречат друг другу.

\Proof $x_s = \varphi(x_k)$, $\dfrac{\id x_s}{\id x_k} = \dfrac{\F_s}{\F_k} \ne 0$.
По теореме о неявной функции, $x_s = \varphi(x_k) \LRA x_k = \psi(x_s)$,
где $\psi'$ непрерывна.
$$
    \dfrac{\id x_p}{\id x_s} = \dfrac{\id x_p \big\slash \id x_k}{\id x_s \big\slash \id x_k} =
    \dfrac{\F_p \big\slash \F_k}{\F_s \big\slash \F_k } = \dfrac{\F_p}{\F_s}.
$$

\Def Система $(1)$~--- симметричная форма записи нормальной системы дифференциальных уравнений.

\Rem В нормальной системе предопределено, какие из переменных независимы, а какие будут искомыми функциями. В симметричной системе $(1)$ это не указано.

\Pic{Chapter5/pic/1.png}

Из рисунка видно, что разным точкам ставим в соответствие разные наборы независимых переменных.
$$
    \dfrac{\id x_1}{\F_1} = \cdots = \dfrac{\id x_n}{\F_n} = \dfrac{\id t}{1}
$$
$$
\dfrac{\id \vec x}{\id t} = \vec{\F}(\vec x), \quad
\vec x = \left\|\stolb{x_1}{\vdots}{x_n}\right\|, \, \vec{\F} = \left\|\stolb{\F_1}{\vdots}{\F_n}\right\|
\eqno (3)
$$
\Rem Автономная система $(3)$ не имеет положения равновесия. (Запрещено, чтобы в какой-либо точке все $\F_k$ обращались в 0). При рисовании фазовых траекторий стрелки рисовать не надо.

На нашей области задана функция $u$. Мы хотим вычислить производную этой функции вдоль решений системы. Но для этого надо знать решение. Теорема говорит, что знать это необязательно.

\Th Пусть $u(\vec x)$ определена в $G$ и непрерывна там вместе с первыми частными производными. Пусть $\vec x (t)$~-- какое-либо решение системы $(3)$. Тогда
$$
    \dfrac{\id u\big(\vec x(t)\big)}{\id t} = \sum\limits_{k=1}^{n} \F_k (\vec x) \dfrac{\partial u(\vec x)}{\partial x_k}
    \eqno(4)
$$
\Proof
Воспользуемся правилом дифференцирования сложной функции:
$$
    \dfrac{\id u\big(\vec x(t)\big)}{\id t} = \sum\limits_{k=1}^n
    \dfrac{\partial u}{\partial x_k}\cdot \dfrac{\partial x_k}{\partial t} =
    \sum\limits_{k=1}^n \F_k \dfrac{\partial u}{\partial x_k}.
$$
\Def Пусть $u(\vec x)$ определена в $G$ и непрерывна там вместе с первыми частными производными. Функция $u(x)$ называется \emph{первым интегралом} системы $(1)$, если $u(\vec x)$ постоянна на каждом решении системы $(1)$.

\Rem Пример. Иногда рассматриваются с.д.у, описывающие движение механической системы. Из физических соображений вводится понятие полной энергии, и доказывается, что имеет место закон сохранения энергии. В нашем определении эта энергия есть первый интеграл той системы, про которую идёт речь.

\Th Пусть $u(\vec x)$ определена в $G$ и непрерывна там вместе с первыми частными производными. Тогда $u(\vec x)$~--- первый интеграл системы $(1)$ в том и только том случае, когда выполняется уравнение $(5) \such$
$$
    \sum\limits_{k=1}^n \F_k (\vec x) \dfrac{\partial u(\vec x)}{\partial x_k} = 0 \, \forall \vec x \in G \eqno (5)
$$
\Proof $u(\vec x)$~--- первый интеграл системы $(1)$ $\LRA$ $u(\vec x)$ постоянно
на каждом решении $(1) \LRA \dfrac{\id u(\vec x(t))}{\id t} = 0$ на каждом решении $(1)$ $\LRA$
$\sum_{k=1}^n \F_k (\vec x) \dfrac{\partial u(\vec x)}{\partial x_k} = 0$ на каждом решении $(1)$ $\LRA$ $\sum_{k=1}^n \F_k (\vec x) \dfrac{\partial u(\vec x)}{\partial x_k} = 0$ в каждой точке $G$.

Это был материал, относящийся к тому, что мы называем первым интегралом, и какие условия нужно наложить, чтобы функция была первым интегралом.

\point{2} Если $u_1(\vec x), \ldots, u_k (\vec x)$~--- первые интегралы уравнения $(1)$ и
$
    \Phi\big( u_1(\vec x), \ldots, u_k(\vec x) \big)
$~--- какая-либо гладкая функция, то $\Phi\big( u_1(\vec x), \ldots, u_k(\vec x) \big)$~--- тоже первый интеграл. Во втором пункте мы опишем совокупность всех первый интегралов $(1)$.

\Rem Мы покажем, что всегда есть несколько первых интегралов, и все остальные выражаются через них с помощью суперпозиций. Все дальнейшие исследования~--- локальные. Это означает, что мы фиксируем $\vec a \in G$, и рассматриваем всё в некоторой окрестности этой точки $\vec a$.

%break

\Def Пусть $u_1(\vec x), \ldots, u_k(\vec x)$~--- первые интегралы $(1)$, определённые в некоторой окрестности точки $\vec a$, $\vec a \in G$. Эти первые интегралы называются \emph{независимыми} в точке $\vec a$, если
$$
    \Rg\left\|
    \begin{array}{ccc}
      \dfrac{\pa u_1(\vec a) }{\pa x_1} & \cdots & \dfrac{\pa u_1 (\vec a)}{\pa x_n} \\
      \cdots & \cdots & \cdots \\
      \dfrac{\pa u_k(\vec a) }{\pa x_1} & \cdots & \dfrac{\pa u_k (\vec a)}{\pa x_n}
    \end{array}
    \right\| = k.
$$
(матрица размера $n \times k$)

\Th Для каждой точки $\vec a \in G$ существует $(n-1)$ независимых первых интегралов $(1)$ и не существует большего числа независимых первых интегралов $(1)$.

\Proof $u_1(\vec x), \ldots, u_k(\vec x)$~--- независимые в $\vec a$ первые интегралы $(1)$.
$$
\begin{array}{c}
  \F_1 (\vec a) \dfrac{\pa u_1 (\vec a)}{\pa x_1} + \ldots + \F_n (\vec a) \dfrac{\pa u_1 (\vec a)}{\pa x_n} = 0 \\
  \cdots \\
  \F_1 (\vec a) \dfrac{\pa u_k (\vec a)}{\pa x_1} + \ldots + \F_n (\vec a) \dfrac{\pa u_k (\vec a)}{\pa x_n} = 0
\end{array}
$$
--- Система линейных автономных уравнений относительно $ \F_1(\vec a), \ldots, \F_n(\vec a)$, матрица системы $\left\| \dfrac{\pa u_i}{\pa x_j} (\vec a) \right\|$.
Эта СЛАУ имеет нетривиальное решение, $\Rg \left\| \dfrac{\pa u_i}{\pa x_j} (\vec a) \right\|$,  $k < n$, $k \leqslant n-1$.

$\vec a = \vec 0$, $\F_n (\vec a) \ne 0$.
$$
    \stolb{\dfrac{\id x_1}{\id x_n} = g_1(\vec x)}
    {\vdots}
    {\dfrac{\id x_{n-1}}{\id x_k} = g_{n-1} (\vec x)}
    \eqno (6)
$$
\Pic{Chapter5/pic/2.png}

$g_r(\vec x) = \dfrac{\F_r}{\F_n}$  непрерывна вместе с первыми частными производными.

$(6)$ рассмотрим в некоторой окрестности точки $\vec a = \vec 0$.

Задача Коши: $x_n = 0, x_1 = \tau_1, \ldots, x_{n-1} = \tau_{n-1}$.
$$
\left[
\begin{array}{c}
  x_1 = \varphi_1 (x_n, \tau_1, \ldots, \tau_{n-1}) \\
  \cdots \\
  x_{n-1} = \varphi_{n-1} (x_n, \tau_1, \ldots, \tau_{n-1})
\end{array}\right. \eqno (7)
$$
Из результатов $\S 4$ Главы 3 следует, что $\varphi_1, \ldots, \varphi_{n-1}$ определены в некоторой окрестности $\vec a$ и непрерывна вместе с первыми частными производными.
$$
    \varphi_k(0, \tau_1, \ldots, \tau_{n-1}) = \tau_k.
$$
Поэтому $\left.\dfrac{\pa \varphi_k}{\pa \tau_r} \right|_{x=0} = \dta_{kr}$
(символ Кронекера, $\dta_{kr} \eqdef \left\{
\begin{array}{c}
  1, \, k = r \\
  0, \, k \ne r
\end{array}
\right.$)

При этом
$$
    \left.
    \dfrac{\pa(\varphi_1, \ldots, \varphi_{n-1})}{\pa(\tau_1, \ldots, \tau_{n-1})}
    \right|_{\vec a} =
    \left|
    \begin{array}{ccc}
      1 &        & 0 \\
        & \ddots &   \\
      0 &        & 1
    \end{array}
    \right| = 1 \ne 0
$$
$(7) \underset{\text{в нек. окрестности $\vec a$}}{\LRA} (8)$
$$
\left\{
\stolb{\tau_1 = p_1(\vec x)}
{\cdots}
{\tau_{n-1} = p_{n-1}(\vec x)},
\right.
\eqno (8)
$$
где $p_1, \ldots, p_{n-1}$ непрерывны вместе в первыми частными производными.

Докажем, что $p_1 (\vec x), \ldots, p_{n-1} (\vec x)$~--- именно нужные нам независимые первые интегралы $(1)$. Ясно, что они являются первыми интегралами, осталось доказать независимость.
$$
    \dfrac{\pa (p_1, \ldots, p_{n-1})}{\pa(x_1, \ldots, x_{n-1})} =
    1 \Big\slash \dfrac{\pa (\varphi_1, \ldots, \varphi_{n-1})}{\pa (\tau_1, \ldots, \tau_{n-1})} = 1 \big\slash 1 = 1 \ne 0.
$$
\Rem Не нужно думать, что эти и только эти интегралы являются искомой совокупностью независимых первых интегралов. Мы построили всего лишь частный случай.

\textbf{Дополнение к теореме.} Графики решений системы $(6)$ (то есть графики функций $(7)$) заполняют некоторую окрестность $\vec a$ (см. $(8)$).

%Дальше докажем: Если в какой-то точке взять любые $n-1$ независимых первых интегралов,
%то любой интеграл будет через них выражаться, а они друг через друга не выражаются.
% Этим будет завершено построение теории первых интегралов.
