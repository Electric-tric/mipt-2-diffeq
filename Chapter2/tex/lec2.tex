%22.11.2011
%Вариационное исчисление, продолжение.
%
%Repeat
%$ t\in [t_1, t_2] $, $y(t)$ рассматриваются функции
%$$ F(y) = \inttt f(\tau, y(\tau), y'(\tau)) d\tau, \quad y(t_1) = y_1, \, y(t_2) = y_2. $$

\point{3}%Point 3
Функции, непрерывно дифференцируемые, удовлетворяющие данным условиям, называются допустимыми.
$$
    F - min. \eqno (1)
$$
    $ y(t) $ -- решение $(1)$ $\RA$
    $$
        f_y = \dfrac{d}{dt} f_{y'} = 0 \eqno (2)
    $$

    $$ \dfrac{d}{dt} f_{y'} = f_{y'} + f_{y'y}y' + f_{y'y'}y'' $$

\textbf{Случаи понижения порядка.}

\begin{enumerate}
  \item $f$ не зависит от $y$, $f(t, y, y') = g(t, y')$
    $$
       -\dfrac{d g_y'}{dt} = 0 \LRA g_{y'}(t,y) = c - \text{const}  \eqno (2')
    $$
  \item $f$ не зависит от $t$, $f(t,y, y') = g(y, y')$
    Рассмотрим выражение $g - y'g_{y'}$. Найдем полную производную по $t$ этого выражения.
    $$
        \dfrac{d}{dt} (g - y'g_{y'}) = g_y \cdot y' + \underline{g_{y'} \cdot y''} -\underline{ y'' \cdot g_{y'} }- y' g_{y'y}y'
        - y' g_{y'y'}y'' = y' \big( g_y - g_{y'y}y' - g_{y'y'} y'' \big)
    $$
    % Hope there is no mistake
    $$
        g_y - g_{y'y}y' - g_{y'y'}y'' = 0 \eqno (2'')\\ %TODO
    $$
    $$ \begin{array}{l}

        \dfrac{d}{dt} (g - y' g_{y'}) = 0, \quad g - y' g_{y'} = c - \text{const} \\ \\
        (2'') \RA g - y' g_{y'} = \text{const}
        \\ \\
        \condition{g - y'g_{y'} = \text{const} } \land \condition{ y' \ne 0 } \RA (2'').
        \end{array}
    $$


    \begin{enumerate} %TODO literal points
      \item $y' = 0$ в отдельных точках. Тогда $g - y' g_{y'} \LRA (2'')$
      \item $y' = 0$ на некотором отрезке. При $y = y_0$ -- const выражение
       $g - y' g_{y'}$ равно нулю.

       $(2'')$ выполняется, если $g_y (y_0, 0) = 0$. То есть нужно найти те $y_0$, для которых
       $g_y (y_0, 0) = 0$.
    \end{enumerate}
\end{enumerate}

\point{4} \textbf{Случай квадратичного функционала. }

$f$ -- многочлен второй степени относительно совокупности $y, y'$.
$$
    f(t,y,y') = p(t) (y')^2 + q(t) y^2 - 2m(t) y.
$$
\Rem Можно возразить, что выписаны не все члены. Но можно показать, что все функции можно привести к такому виду:
$$
    \inttt a(t) y y' dt = \dfrac12 \Big[a(t) y^2(t)\Big] \Big| _{t_1} ^{t_2} - \dfrac12 \inttt a'(t) y^2 (t) dt,
$$
$$
    \inttt b(t) y' dt   = \Big[b(t) y(t)\Big] \Big| _{t_1} ^{t_2} - \inttt b'(t) y(t) dt ,
$$
$$
    \inttt c(t) dt \text { не зависит от выбора } y(t).
$$
Далее предполагаем, что $p'(t)$, $q(t)$, $m(t)$ непрерывны на отрезке $[t_1, t_2]$.

\Quest{Как выглядит уравнение Эйлера в этом случае?}
\Ans
$$
    2qy - 2m - 2(py')' = 0
$$
$$
 -(p(t)y')' + q(t) y = m(t) \LRA -py'' - p'y' + qy = m \eqno (3)
$$
\Th Пусть $p(t) > 0$ и $q(t) \geqslant 0$ на $[t_1, t_2]$.
Пусть $y(t)$ -- решение уравнения $(3)$, удовлетворяющее условиям
$ y(t_1) = y_1 $,  $y(t_2 ) = y_2$. Тогда $y(t)$ дает минимум $F$.

\Rem До сих пор я подчеркивал несколько раз, что мы выводим уравнение Эйлера,
и если уравнение Эйлера выполнялось, нужно было проводить дополнительное исследование.
Для конкретно этого важного частного случая такое исследование можно провести.

%5 minutes break
\comment{Как принято во всяких сериалах, прерываемся на самом интересном месте.}

\Proof Берем нашу функцию $y(t)$, какую-то $\eta(t)$, такую, что
$\eta(t_1) = \eta (t_2) = 0$, $\eta(t)$ -- непрерывно дифференцируемая, $\alpha$ -- число (любое).

$$
    \tilde{y} (t) \eqdef y(t) + \alpha y(t)
$$
Приращение функционала представляем в виде суммы линейной части и членов более высокого порядка.
$$
    F(\tilde{y}) = F(y) + \underbrace{\dta F}_{=0} + \alpha^2 \inttt \big( p(t) (\eta')^2 + q(t)\eta^2\big) dt
    \geqslant F(y)
$$
    Мы доказали, что функция дает минимум. Важно: имеется ввиду \emph{глобальный} минимум.
    Если $\alpha \eta(t)$ не тождественно нулевая функция, то $F(\tilde{y}) > F(y)$.

    \Rem Можно ли гарантировать, что существует решение уравнения (3), удовлетворяющее граничным условиям?
    Пока мы не можем ответить на этот вопрос. Во втором семестре мы докажем, что уравнение (3) \emph{имеет}
    решение, и притом \emph{единственное}.

\point{5} \textbf{Задача о брахистохроне. }

\Pic{Chapter2/pic/2.png}

\Rem В 1696 году Иоганн Бернулли опубликовал работу ``задача о брахистохроне''.
Считается, что эта работа положила начало вариационному исчислению. Была рассмотрена следующая задача:
в вертикальной плоскости лежат точки $A$, $B$, соединенные некоторой кривой. Под действием силы тяжести по этой
кривой скатывается материальная точка. Нужно найти ту кривую, по которой время движения будет минимальным.
Эту кривую он назвал брахистохрона (кривая кратчайшего времени, греч.)

Казалось бы, логичнее всего двигаться по отрезку прямой. Оказывается, это не так.

Поместим точку $A$ в начало координат, вертикально вниз направлена ось $y$, где-то задана точка $B$.
$$
    A(0,0),\quad B(x_1, y_1)
$$
Ограничимся кривыми, задаваемыми уравнениями $y = y(x), 0 \leqslant x \leqslant x_1$.

$v$ -- скорость, $v = v(x,y)$.

$$
    \begin{array}{l}
    \dfrac{mv^2}{2} = mgy
\\ \\
    v = \sqrt{2gy},
      \quad T = \I_{\ell} dt = \I_{\ell}
      \dfrac{ds}{v}
      = \dfrac{1}{\sqrt{2g}} \I_0^{x_1} \sqrt{\dfrac{1+ (y')^2}{y}}dx
\\ \\
    F(x) = \dfrac{1}{\sqrt{2g}} \I_0^{x_1} \dfrac{\sqrt{1+(y')^2}}{\sqrt{y}}dx, \quad F - min
    \end{array}
$$
Неприятность заключается в том, что на левом конце особенность в нуле.
Не будем обращать внимания на эту особенность, а потом посмотрим, во что это нам обойдется.

Уравнение Эйлера допускает понижение порядка, потому что подынтегральная функция не зависит от $t$.

$$
    \sqrt{\dfrac{1+(y')^2}{y}} - y' \cdot \dfrac{2y'}{2\cdot \sqrt{y(1+(y')^2)}} = c - \text{ const}.
$$
Сразу напишем ответ (легко проверить подстановкой).
Рассмотрим функции, задаваемые уравнениями
$$
\left\{
\begin{array}{l}
    x = R(t - \sin t) + Q\\
    y = R(q - \cos t)
\end{array}
\right. ,
$$
где $R$ и $Q$ -- const, t -- параметр на решение.

\Pic{Chapter2/pic/3.png}

Эта кривая называется циклоидой. (Мы будем брать из нее кусочки)

Возьмем $Q = 0$, тогда $y(0) = 0$. $R = ?$

Нарисуем циклоиду, соответствующую $R = 1$, потом изменим нашу циклоиду
(растяжением или сжатием) так, чтобы $R = \dfrac{AB}{AC}. \quad$
$R$ определена однозначно условием $y(t_1) = y_1$.

\Pic{Chapter2/pic/4.png}

Оказывается, брахистохроной является часть циклоиды.

\Rem Так как Бернулли жил до Эйлера, то он не мог воспользоваться тем приемом, которым
пользовались мы, он делал это как-то по-другому. С другой стороны, мы тоже нестрого решили задачу,
так как мы пользовались дополнительными предположениями. Путем кропотливой работы можно показать,
что найденное нами решение действительно является минимальным.

\Rem При $x$ близком к 0, $\tau \approx 0$, $x \approx \dfrac{Rt^3}{6}$, $y \approx \dfrac{Rt^3}{2}$.

$x = o(y)$, касательная вертикальна в начальной точке.

[ На лекции было описано геометрическое построение R ]

Дадим формулу для времени:
$$
    x = R(t - \sin t), \quad y = R(q - \cos t).
$$
$$
    t = \I_{0}^{\tau_0} \sqrt{\dfrac{(\dot{x})^2 + (\dot{y})^2}{y}}d\tau =
    \dfrac{1}{\sqrt{2g}}\I_{0}{\tau_0}\sqrt{2R} d\tau = \sqrt{\dfrac{R}{g}}\tau_0
$$

Мы до сих пор рассматривали случай, когда $B$ намного ниже точки $A$. Интересно рассмотреть
случай, когда $x_1$ не мало, $y_1$ мало. 
Точка падает, разгоняется, и доходит до точки $B$. Таким образом, под действием силы тяжести можно передвигаться в горизонтальном направлении.

\Pic{Chapter2/pic/5.png}
$$
    AB = L, \quad R = \dfrac{L}{2\pi}, \quad \tau_0 = 2\pi
$$
$$
    T = \sqrt{\dfrac{L}{2\pi q}}\cdot 2\pi = \sqrt{\dfrac{2\pi L}{g}}
$$
\Rem L = 600 км, $\tau \approx 600$ сек $\approx$ 10 мин.

