      \item Эта теорема может быть доказана очень многими способами. Мы выбрали метод ломаных Эйлера.
          \Pic{Chapter3/pic/5.png}
          Эта построенная ломаная называется \emph{Ломаной Эйлера}. Таким образом был предложен приближённый метод решения дифференциального уравнения. На каждом отрезке вместо решения строим отрезок, который в начальной точке имеет направление, заданное нашим дифференциальным уравнением.

          Затем мы доказывали, что наше приближённое решение при $h \to 0$ становится точным.

          \textbf{Задача: составить программу приближённого решения задачи Коши, используя метод Эйлера приближённого решения.} Можно попробовать решать задачи из задания таким способом.
      \item В одной из теорем мы объединили два формально разных вопроса: существования и единственности решения задачи Коши. В более тонких исследованиях эти два вопроса разделяются. Оказывается, что если правая часть уравнения только непрерывна (раньше требовалось дифференцируемость), то хотя бы одно решение задачи Коши существует.
      \item Конечно, условие в этой теореме --- это достаточное условие, и вовсе не является необходимым. Рассмотрим 2 примера.
          \begin{itemize}
            \item $y' = \sqrt[3]{y^2}$
            \item $y' = \sqrt[3]{y^2} + 1$
          \end{itemize}
          \textbf{Контрольный вопрос:} Почему? Какие условия теоремы не выполнены?
    \end{enumerate}

\subsection{Исследование зависимости решения от параметров, входящих в правую часть уравнения и начальных данных}

В этом параграфе все величины вещественные.

Мы рассматриваем уравнение
$$
 \dfrac{\id \vec{y}}{\id t} = \vec{f} \big( t, \vec y, \vec{y}' \big)   \eqno(1)
$$
$$
    \vec{y} = \left\|
    \begin{array}{c}
      y_1 \\
      \vdots \\
      y_n
    \end{array}
    \right\|,
    \vec{f} = \left\|
    \begin{array}{c}
      f_1 \\
      \vdots \\
      f_n
    \end{array}
    \right\|,
    \vec{\mu} = \left\|
    \begin{array}{c}
      \mu_1 \\
      \vdots \\
      \mu_n
    \end{array}
    \right\|,
$$
$\vec{f} (t, \vec y, \vec{y}') $ определена в замкнутой области $G_{t, \vec y, \vec \mu}$.

Тогда мы получим, что решение зависит от параметра и начальных данных.

$$
    \vec{y} (t_0)  = \vec{y_0}\eqno(2)
$$

В этой параграфе мы будем изучать функцию $y$, как функцию всей совокупности переменных. Сначала рассмотрим зависимость решения от параметра при фиксированных начальных данных, а потом уже посмотрим, как изучить зависимость при переменных начальных данных.

\point{1}
\Th Пусть $\vec{f}$ и $\dfrac{\id \vec{f}}{\id t}$ непрерывны в $G$. Пусть $\big( t_0, \vec{y_0}, \vec{\mu_0} \big)$ --- внутренняя точка $G$. Тогда существуют положительные числа $\alpha, \gamma$, такие, что при $|t - t_0| \leqslant \alpha$ и $|\vec{\mu} - \vec{\mu_0}| \leqslant \gamma$ определено решение (единственное) задачи $(1) \land (2)$ и функция $\vec{y}(t, \vec\mu)$ непрерывна.

\Proof Мы берём нашу точку $\big(t_0, \vec{y_0}, \vec{\mu_0}\big)$, и такую окрестность $U$, что $\bar U \subset \bar G$. Обозначим
$M = \max_{\bar U} |\vec f|$. (Можно показать, что такое обозначение корректно, максимум существует).

Возьмём такой цилиндр $Q \{ |t - t_0| \leqslant \alpha, |\vec y - \vec{y_0}| \leqslant \beta, |\vec \mu - \vec{\mu_0}|
\leqslant \gamma \}$ (бицилиндр), что
$$
    0 < \alpha, 0 < \beta, 0 < \gamma, \alpha M \leqslant \beta,
    Q \subset \bar U. K = \max_{Q} \left| \dfrac{\partial \vec f}{\partial \vec y} \right|
$$
Мы берём два значения $\vec{\mu_1}, \vec{\mu_2};$ $\vec{y}(t, \vec{\mu_1}), \vec{y})(t, \vec{\mu_2})$ --- решение $(1) \land (2)$.

Как следует из конструкции построения этих решений, приведенных в предыдущем параграфе, эти решения определены на всём отрезке.

Посмотрим, будут ли эти решения близки, если $\vec{\mu_1}$ близко к $\vec{\mu_2}$.

%\def vec{\mu} = \vm
$$
    \dfrac{\id \vec y (t, \vm_1)}{\id t} = \vec{f} \Big( t, \vec y (t, \vm_1), \vm_1  \Big)
$$
$$
    |\vec f (t, \vec y(t, \vm_1), \vm_1) - \vec f(t, \vec y(t, \vm_2), \vm_1)| < \eps, \eqno (3)
$$
если
$$
    |\vm_1 - \vm_2| < \dta, \text{ где }\eps \to 0 \text{ при }
    \dta \to 0,
$$
так как $\vec{f}$ равномерно непрерывна в $Q$.

Тогда
$$
    \left|\dfrac{\id \vec{y} (t, \vm_1)}{\id t} - \vec f(t, \vec y(t, \vm_1), \vm_2) \right| < \eps,
$$
если $|\vm_1 - \vm_2| < \dta$.
Таким образом, обе функции являются $\eps$-приближёнными. Одна из них является точным решением. Всё происходит в замкнутом выпуклом множестве, функции удовлетворяют одним и тем же начальным условиям, поэтому
$$
    |\vec y(t, \vm_1) - \vec y(t, \vm_2)| \leqslant 2 \alpha \eps e^{K\alpha}
$$
\Rem Непрерывность следует из неравенства треугольника:
$
|\vec y(t_1, \vm_1) - \vec y(t_2, \vm_2)| \leqslant
|\vec y (t_1, \vm_1) - \vec y(t_1, \vm_2)|
+
|\vec y (t_1, \vm_2) - \vec y(t_2, \vm_2)| \leqslant
2 \alpha \eps e^{L \alpha} +
M |t_1 - t_2|
$
Теорема доказана.

\point{2}
\Th Пусть в дополнение к условиям предыдущей теоремы $\dfrac{\partial \vec f}{\partial \vm}$  непрерывна в $\bar G$. Тогда функция $\vec y(t, \vm)$ имеет непрерывные производные $V = \dfrac{\partial \vec y}{\partial \vm}$ и функция $V$ удовлетворяет уравнению
$$
    \dfrac{\id V }{\id t} = \left(
        \dfrac{\partial \vec f}{\partial \vec y} \big( t, \vec y(t, \vm), \vm  \big)
    \right)V +
    \dfrac{\partial \vec f}{\partial \vm} \big( t, \vec y(t, \vm), \vm \big)
    \eqno(4)
$$
и начальному условию
$$
    V(t_0) = 0 \eqno(5)
$$

\Rem Уравнение $(4)$ называется \emph{уравнением вариации} для уравнения $(1)$. Оно получается из $(1)$ формальным дифференцированием по $\vm$. (Это всего лишь способ запомнить это уравнение. Вообще, никто не давал разрешения своевольно переставлять порядок дифференцирования.)

\Rem $V$--- прямоугольная матрица частных производных, которая имеет $m$ столбцов и $n$ строк. ($n \times m$).

% break

\Proof Рассмотрим уравнение $(4)$,  с начальными условиями $(5)$. Это уравнение, которое удовлетворяет всем требованиям того, чтобы решение задачи Коши существовало и было единственно.  Дейтсвительно, частная производная (матрица) тоже непрерывна.
$$
    V(t, \vm) \text{ --- решение, единственное задачи } (4) \land (5)
$$
То, что это решение распространяется на весь отрезок $[t_0 - \alpha, t_0 + \alpha]$, будет доказано позднее, при изучении линейных уравнений с переменными коэффициентами. 

$|t - t_0| \leqslant \alpha, |\vm - \vm_0|\leqslant \beta$. Хотим доказать, что эта функция является частной производной $\dfrac{\partial \vec y}{\partial \vm}$.
Берём $\vm, \Delta \vm$, и составляем функцию
$$
    \vec z(t, \vm, \Delta \vm) \eqdef
    \vec y (t, \vm + \Delta \vm) - \vec y(t, \vm) - V(t, \vm)\cdot \Delta \vm
$$
Мы докажем, что $||\vec z|| = o(|| \Delta \vm ||)$. Здесь и далее $o(\cdot), O(\cdot)$~--- равномерные в $Q$ оценки.

Если доказать, что $\vec z = o(||\Delta \vm||)$, то всё будет следовать.

Напишем дифференциальное уравнения для $\vec z$.
$$
    \dfrac{\id \vec z}{\id t} = \underbrace{\vec f\big(t, \vec y(t, \vm + \Delta \vm), \vm + \Delta \vm\big) -
    \vec f \big( t, \vec y(t, \vm), \vm \big)}_{\Delta \vec f} -
    \dfrac{\partial \vec f}{\partial \vec y} \underline{V \Delta \vm} - \dfrac{\partial \vec f}{\partial \vm} \Delta \vm
$$
Оценим эту величину. Отметим, что из соотношения $(3)$, использованного при доказательстве предыдущей теоремы, следует, что $\eps = O(\dta)$. Дело в том, что мы предположили, что функция дифференцируема. Тогда разность в неравенстве (3) не превосходит разницы частных производных, умноженной на ?

Поэтому (см. доказательство предыдущей теоремы)
$$
    \Big( \vec y(t, \vm - \Delta \vm) - \vec y(t, \vm) \Big) = O(|\Delta \vm|)
$$
Преобразуем:
$$
    \dfrac{\id \vec z}{\id t} = \Delta \vec f - \dfrac{\partial \vec f}{\partial \vec y}\Delta \vec y - 
    \dfrac{\partial \vec f}{\partial \vm} \Delta \vm + \dfrac{\partial \vec f}{\partial \vec y}\vec z
$$
Поскольку $\vec f$ имеет непрерывные частные производные,
$$
    \left| \Delta \vec f - \dfrac{\partial \vec f}{\partial \vec y}\Delta \vec t -
    \dfrac{\partial \vec f}{\partial \vec \mu}\Delta \vm \right| = 
    o\left( |\Delta \vec y| + |\Delta \vm| \right) =
    o\left( | \Delta \vm |\right)
$$
$$
    A(t) \eqdef \dfrac{\partial \vec f}{\partial \vec y}(t, \vec y(t, \vm), \vm)
$$
$$
    \dfrac{\id \vec z}{\id t} = A(t) \vec z + \vec \rho(t), \text{ где } |\vec \rho(t)| = o(|\Delta \vm|)
$$
$\vec z(t_0) = \vec 0$.

Надо доказать, что $\vec z = o(|\Delta \vm|)$. Введём вспомогательную функцию
$$
    \vec \varphi(t) \eqdef \vec 0
$$
Эта функция, подставленная в наше дифференциальное уравнение
$$
    \left|\dfrac{\id \vec \vphi(t)}{\id t} - A(t) \vec \vphi(t) - \vec \rho(t)\right| = 
    |\vec \rho(t)| = o(|\Delta \vm|),
$$
даёт погрешность
$$
    |\vec z(t) - \vec \vphi(t)| \leqslant 2 o(\Delta \vm)\cdot \alpha e^{K \alpha} = o(|\Delta \vm|)
$$
$$
    |\vec z(t)| = o(|\Delta \vm|).
$$
Теорема доказана.

Осталось доказать, что $\dfrac{\id V}{\id t}(t_0) = 0$. Так как мы не меняем начальных данных, то так и есть.

\point{3} \textbf{Зависимость решения от начальных данных}.

\Rem Это очень просто исследовать

Сделаем замену $\vec y = \vec{y_0} + \eta$, $t = t_0 + \tau$.
Тогда уравнение $(1)$ становится эквивалентным
$$
    \dfrac{\id \vec \eta}{\id \tau} = \vec{f} (t_0 + \tau, \vec{y_0} + \vec \eta, \vm) \eqdef 
    \vec g(\tau, \vec \eta, \vm) (t_0, \vec{y_0})\eqno(1')
$$
$$
    (2) \LRA \vec \eta(0) = \vec 0
$$
Начальные данные фиксировали, а в преобразованные данные стали параметрами.

\point{4} \textbf{Несколько дополнительных замечаний}
\begin{itemize}
  \item \textbf{Обязательная задача}. Для уравнения (стрелочек нет)
  $$
    y^{(n)} = f(t, y, y', \ldots, y^{(n-1)})
  $$
  пользуясь тем, что оно сводится к нормальной системе
  $y' = z_1$, $z'_1 = z_2, \ldots, z'_{n-2} = z_{n-1}, z'_{n-1} = f(t, t, y, z_1, \ldots, z_{n-1})$
  \emph{сформулировать} (и доказать) результаты, соответствующие теоремам пп.1-3.
  
  
  \item Мы привыкли к тому, что система $n$ уравнений имеет общее решение, зависящее от $n$ произвольных постоянных.
      \PicStub
      
      $t_0$ --- фиксированное, $y_0 = C$~--- параметр.
      $$
        \vec y = \vec y(t, \vec C)
      $$
      
  \item Наложив более жёсткие ограничения на функцию $\vec f$, можно доказать существование и непрерывность
  высших производных $\vec y$ по $\vec \mu$.
\end{itemize}

\Rem Представьте, что дифференциальное уравнение, описывающее, например, полёт самолёта, разрывно зависит от некоторых параметров (например, веса). Малые изменения параметра влекут большие изменения решения. Поэтому теорема пункта 1 имеет фундаментальное значение для использования в практических целях. 